!function(t,e){function n(e){var n,r,o=this;n={href:"",title:"&middot;&middot;&middot;",children:[],templates:{},container:null},r=t.extend(n,e),o.href=r.href,o.title=r.title,o.children=r.children,o.templates=r.templates,o.$container=r.container,o.node=null,o.attachedNode=null,o.options={},o.visible=!0}var r={menu:'<li class="%1$s"><a href="%2$s">%3$s</a>%4$s</li>',child_wrap:"<ul>%s</ul>",child:'<li class="%1$s"><a href="%2$s">%3$s</a></li>'};n.prototype.set=function(t,r){if(!1==t instanceof n)throw new Error("Invalid argument type");return e===r?this.children.push(t):this.children[r]=t,this},n.prototype.push=function(t){return this.set(t)},n.prototype.get=function(t){return this.has(t)?this.children[t]:null},n.prototype.has=function(t){return e!==this.children[t]},n.prototype.isVisible=function(){return this.visible},n.prototype.forEach=function(t){return this.children.forEach(t)},n.prototype.countVisibleAttachedNodes=function(){var e=this,n=-1;return e.children.forEach(function(e){t(e.getAttachedNode()).attr("hidden")||n++}),n},n.prototype.countVisibleNodes=function(){var e=this,n=0;return e.children.forEach(function(e){t(e.getNode()).attr("hidden")||n++}),n},n.prototype.countVisible=function(){var t=this,e=0;return t.children.forEach(function(t){t.isVisible()&&e++}),e},n.prototype.getNode=function(){return this.node},n.prototype.getAttachedNode=function(){return this.attachedNode},n.prototype.setNode=function(t){this.node=t},n.prototype.attachNode=function(t){this.attachedNode=t},n.prototype.cache=function(t,e){var n=this;return n.children.forEach(function(n,r){n.setNode(t[r]),n.attachNode(e[r])}),n},n.prototype.setOptions=function(t){return this.options=t,this},n.prototype.getOptions=function(){return this.options},n.prototype.render=function(){function t(t){return t=t||"",r.templates.menu.replace(/\%1\$s/g,"super-guacamole__menu menu-item"+(""===t?"":" menu-item-has-children")).replace(/\%2\$s/g,r.href).replace(/\%3\$s/g,r.title).replace(/\%4\$s/g,t?r.templates.child_wrap.replace(/\%1\$s/g,"sub-menu").replace(/\%2\$s/g,t):"")}function e(){return i=[],r.children.forEach(function(t){t instanceof n&&i.push(r.templates.child.replace(/\%1\$s/g,"super-guacamole__menu__child menu-item").replace(/\%2\$s/g,t.href).replace(/\%3\$s/g,t.title))}),i}var r=this,o=r.options.$menu,i=[];return r.$container&&(r.$container.append(t(e().join("\n"))),r.cache(r.$container.find(".super-guacamole__menu * .super-guacamole__menu__child"),o.children(r.options.childrenFilter+":not(.super-guacamole__menu):not(.super-guacamole__menu__child)"))),r},n.extract=function(e){var r,o,i=[];return e.each(function(e,a){r=t(a),o=new n({href:r.children("a").attr("href"),title:r.children("a").text()}),o.attachNode(r),i.push(o)}),i},n.prototype.attachedNodesFit=function(){var e,n=this,r=0,o=0,i=n.$container.outerWidth(!0)-n.$container.find(".super-guacamole__menu").outerWidth(!0);return n.children.forEach(function(n){$attachedNode=t(n.getAttachedNode()),e=t(n.getNode()),$attachedNode.removeAttr("hidden"),e.attr("hidden",!0)}),n.children.forEach(function(a,c){$attachedNode=t(a.getAttachedNode()),e=t(a.getNode()),o=$attachedNode.outerWidth(!0),o>0&&$attachedNode.data("width",o),r+=$attachedNode.data("width"),r>i&&c>=n.options.minChildren&&($attachedNode.attr("hidden",!0),e.removeAttr("hidden"))}),!0},n.prototype.menuFit=function(e){var n=this,r={removeAttr:function(t,e){return t.removeAttr(e)},attr:function(t,e){return t.attr(e,!0)}},o="removeAttr",i=n.options.threshold||768;return e=e||!1,0===n.countVisibleNodes()&&(o="attr"),i-1>=t(window).width()&&(n.children.forEach(function(e){$attachedNode=t(e.getAttachedNode()),$node=t(e.getNode()),$attachedNode.removeAttr("hidden"),$node.attr("hidden",!0)}),o="attr"),e||r[o](n.$container.find(".super-guacamole__menu"),"hidden"),"removeAttr"===o},n.prototype.watch=function(e){function n(){o.attachedNodesFit(),o.menuFit()}function r(t){var e;return function(){function r(){n(),timeout=null}e&&clearTimeout(e),e=setTimeout(r,t)}}var o=this;return(e=e||!1)?(n(),o):(t(window).on("resize",r(10)),t(window).on("orientationchange",r(10)),o)},t.fn.superGuacamole=function(e){var o,i,a,c,d=t(this),h=d.find("#main-menu");o={threshold:544,minChildren:3,childrenFilter:"li",menuTitle:"&middot;&middot;&middot;",menuUrl:"#",templates:r},i=t.extend(o,e),a=h.children(i.childrenFilter+":not(.super-guacamole__menu):not(.super-guacamole__menu__child)"),c=new n({title:i.menuTitle,href:i.menuUrl,templates:i.templates,children:n.extract(a),container:h}),i.$menu=h,c.setOptions(i).render().watch(!0).watch()}}(jQuery);